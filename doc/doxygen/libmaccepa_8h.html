<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Hardware Toolbox: /home/fan/hwt/vsa/include/libmaccepa.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Hardware Toolbox
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a4b96529950d21a52c4414fb35dcd57d.html">vsa</a></li><li class="navelem"><a class="el" href="dir_5a92158ec9e309c5bc292aa4e29987a5.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">libmaccepa.h File Reference<div class="ingroups"><a class="el" href="group__MACCEPA.html">MACCEPA</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Library of functions for calculating dynamics properties of the MACCEPA.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &quot;../sketchbook/maccepa/defines.h&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for libmaccepa.h:</div>
<div class="dyncontent">
<div class="center"><img src="libmaccepa_8h__incl.png" border="0" usemap="#_2home_2fan_2hwt_2vsa_2include_2libmaccepa_8h" alt=""/></div>
<map name="_2home_2fan_2hwt_2vsa_2include_2libmaccepa_8h" id="_2home_2fan_2hwt_2vsa_2include_2libmaccepa_8h">
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="libmaccepa_8h__dep__incl.png" border="0" usemap="#_2home_2fan_2hwt_2vsa_2include_2libmaccepa_8hdep" alt=""/></div>
<map name="_2home_2fan_2hwt_2vsa_2include_2libmaccepa_8hdep" id="_2home_2fan_2hwt_2vsa_2include_2libmaccepa_8hdep">
<area shape="rect" id="node2" href="libmaccepa_8c.html" title="Library of functions for calculating dynamics properties of the MACCEPA. " alt="" coords="5,97,152,138"/><area shape="rect" id="node3" href="mex__libmaccepa_8c.html" title="MEX gateway to MACCEPA dynamics library (libmaccepa). " alt="" coords="177,97,324,138"/></map>
</div>
</div>
<p><a href="libmaccepa_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmaccepa__model.html">maccepa_model</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">struct containing dynamics model parameters.  <a href="structmaccepa__model.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a1c4dcebf44d0d22cca0f99580fb7ae54"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1c4dcebf44d0d22cca0f99580fb7ae54"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmaccepa_8h.html#a1c4dcebf44d0d22cca0f99580fb7ae54">DIMX</a>&#160;&#160;&#160;2*<a class="el" href="libedinburghvsa_8h.html#aafb44d5b1a4aad629f9e40571fd711e4">DIMQ</a></td></tr>
<tr class="memdesc:a1c4dcebf44d0d22cca0f99580fb7ae54"><td class="mdescLeft">&#160;</td><td class="mdescRight">State dimensionality. <br/></td></tr>
<tr class="separator:a1c4dcebf44d0d22cca0f99580fb7ae54"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a222ddd307288e014996419e1b717a8a9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmaccepa_8h.html#a222ddd307288e014996419e1b717a8a9">maccepa_model_init</a> (<a class="el" href="structmaccepa__model.html">maccepa_model</a> *<a class="el" href="mex__libmaccepa_8c.html#af6904ccacb333f437667d0a0511bd11a">model</a>)</td></tr>
<tr class="memdesc:a222ddd307288e014996419e1b717a8a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise model struct (set default parameters).  <a href="#a222ddd307288e014996419e1b717a8a9">More...</a><br/></td></tr>
<tr class="separator:a222ddd307288e014996419e1b717a8a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a153d0c93d90ccfd837f09dc78f77cdea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmaccepa_8h.html#a153d0c93d90ccfd837f09dc78f77cdea">maccepa_model_get_torque</a> (double *tau, double *x, double *u, <a class="el" href="structmaccepa__model.html">maccepa_model</a> *<a class="el" href="mex__libmaccepa_8c.html#af6904ccacb333f437667d0a0511bd11a">model</a>)</td></tr>
<tr class="memdesc:a153d0c93d90ccfd837f09dc78f77cdea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate total joint torque as a function of current state and command.  <a href="#a153d0c93d90ccfd837f09dc78f77cdea">More...</a><br/></td></tr>
<tr class="separator:a153d0c93d90ccfd837f09dc78f77cdea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa861367ea3a44ba3ab6eaceff0a10f59"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmaccepa_8h.html#aa861367ea3a44ba3ab6eaceff0a10f59">maccepa_model_get_actuator_torque</a> (double *tau, double *x, double *u, <a class="el" href="structmaccepa__model.html">maccepa_model</a> *<a class="el" href="mex__libmaccepa_8c.html#af6904ccacb333f437667d0a0511bd11a">model</a>)</td></tr>
<tr class="memdesc:aa861367ea3a44ba3ab6eaceff0a10f59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate joint torque due to actuators as a function of current state and command.  <a href="#aa861367ea3a44ba3ab6eaceff0a10f59">More...</a><br/></td></tr>
<tr class="separator:aa861367ea3a44ba3ab6eaceff0a10f59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a90a2eb7a82c0f133fb85a24dd5ccd6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmaccepa_8h.html#a5a90a2eb7a82c0f133fb85a24dd5ccd6">maccepa_model_get_damping_torque</a> (double *tau, double *x, double *u, <a class="el" href="structmaccepa__model.html">maccepa_model</a> *<a class="el" href="mex__libmaccepa_8c.html#af6904ccacb333f437667d0a0511bd11a">model</a>)</td></tr>
<tr class="memdesc:a5a90a2eb7a82c0f133fb85a24dd5ccd6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate joint torque due to damping as a function of current state and command.  <a href="#a5a90a2eb7a82c0f133fb85a24dd5ccd6">More...</a><br/></td></tr>
<tr class="separator:a5a90a2eb7a82c0f133fb85a24dd5ccd6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4520c909672c79ec90df9a6cf224d568"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmaccepa_8h.html#a4520c909672c79ec90df9a6cf224d568">maccepa_model_get_gravity_torque</a> (double *tau, double *x, double *u, <a class="el" href="structmaccepa__model.html">maccepa_model</a> *<a class="el" href="mex__libmaccepa_8c.html#af6904ccacb333f437667d0a0511bd11a">model</a>)</td></tr>
<tr class="memdesc:a4520c909672c79ec90df9a6cf224d568"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate joint torque due to gravity as a function of current state and command.  <a href="#a4520c909672c79ec90df9a6cf224d568">More...</a><br/></td></tr>
<tr class="separator:a4520c909672c79ec90df9a6cf224d568"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abea5459436526c29a64c767d2ec55b77"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmaccepa_8h.html#abea5459436526c29a64c767d2ec55b77">maccepa_model_get_friction_torque</a> (double *tau, double *x, double *u, <a class="el" href="structmaccepa__model.html">maccepa_model</a> *<a class="el" href="mex__libmaccepa_8c.html#af6904ccacb333f437667d0a0511bd11a">model</a>)</td></tr>
<tr class="memdesc:abea5459436526c29a64c767d2ec55b77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate joint torque due to friction as a function of current state and command.  <a href="#abea5459436526c29a64c767d2ec55b77">More...</a><br/></td></tr>
<tr class="separator:abea5459436526c29a64c767d2ec55b77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90055175283111ee3fa02a60f151f5d5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmaccepa_8h.html#a90055175283111ee3fa02a60f151f5d5">maccepa_model_get_acceleration</a> (double *acc, double *x, double *u, <a class="el" href="structmaccepa__model.html">maccepa_model</a> *<a class="el" href="mex__libmaccepa_8c.html#af6904ccacb333f437667d0a0511bd11a">model</a>)</td></tr>
<tr class="memdesc:a90055175283111ee3fa02a60f151f5d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate joint accleration as a function of current state and command.  <a href="#a90055175283111ee3fa02a60f151f5d5">More...</a><br/></td></tr>
<tr class="separator:a90055175283111ee3fa02a60f151f5d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad92b4505d52c236c7d2068e8b99791d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmaccepa_8h.html#aad92b4505d52c236c7d2068e8b99791d">maccepa_model_get_equilibrium_position</a> (double *q0, double *x, double *u, <a class="el" href="structmaccepa__model.html">maccepa_model</a> *<a class="el" href="mex__libmaccepa_8c.html#af6904ccacb333f437667d0a0511bd11a">model</a>)</td></tr>
<tr class="memdesc:aad92b4505d52c236c7d2068e8b99791d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate equilibrium position as a function of current state and command.  <a href="#aad92b4505d52c236c7d2068e8b99791d">More...</a><br/></td></tr>
<tr class="separator:aad92b4505d52c236c7d2068e8b99791d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92626951a8b47ac95bd28dd4b2e7de67"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmaccepa_8h.html#a92626951a8b47ac95bd28dd4b2e7de67">maccepa_model_get_equilibrium_position_jacobian</a> (double *J, double *x, double *u, <a class="el" href="structmaccepa__model.html">maccepa_model</a> *<a class="el" href="mex__libmaccepa_8c.html#af6904ccacb333f437667d0a0511bd11a">model</a>)</td></tr>
<tr class="memdesc:a92626951a8b47ac95bd28dd4b2e7de67"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Jacobian of equilibrium position with respect to motor commands (as a function of current state and command).  <a href="#a92626951a8b47ac95bd28dd4b2e7de67">More...</a><br/></td></tr>
<tr class="separator:a92626951a8b47ac95bd28dd4b2e7de67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4d7524d48f4b1fd42b060e07a96d235"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmaccepa_8h.html#aa4d7524d48f4b1fd42b060e07a96d235">maccepa_model_get_stiffness</a> (double *k, double *x, double *u, <a class="el" href="structmaccepa__model.html">maccepa_model</a> *<a class="el" href="mex__libmaccepa_8c.html#af6904ccacb333f437667d0a0511bd11a">model</a>)</td></tr>
<tr class="memdesc:aa4d7524d48f4b1fd42b060e07a96d235"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate stiffness as a function of current state and command.  <a href="#aa4d7524d48f4b1fd42b060e07a96d235">More...</a><br/></td></tr>
<tr class="separator:aa4d7524d48f4b1fd42b060e07a96d235"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4af92c8a3f2a091b4e4afa7c688d43a4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmaccepa_8h.html#a4af92c8a3f2a091b4e4afa7c688d43a4">maccepa_model_get_stiffness_jacobian</a> (double *J, double *x, double *u, <a class="el" href="structmaccepa__model.html">maccepa_model</a> *<a class="el" href="mex__libmaccepa_8c.html#af6904ccacb333f437667d0a0511bd11a">model</a>)</td></tr>
<tr class="memdesc:a4af92c8a3f2a091b4e4afa7c688d43a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate Jacobian of stiffness with respect to motor commands (as a function of current state and command).  <a href="#a4af92c8a3f2a091b4e4afa7c688d43a4">More...</a><br/></td></tr>
<tr class="separator:a4af92c8a3f2a091b4e4afa7c688d43a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93b2ab024cf83bb56297d0a56959b216"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmaccepa_8h.html#a93b2ab024cf83bb56297d0a56959b216">maccepa_model_get_damping</a> (double *b, double *x, double *u, <a class="el" href="structmaccepa__model.html">maccepa_model</a> *<a class="el" href="mex__libmaccepa_8c.html#af6904ccacb333f437667d0a0511bd11a">model</a>)</td></tr>
<tr class="memdesc:a93b2ab024cf83bb56297d0a56959b216"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate damping as a function of current state and command.  <a href="#a93b2ab024cf83bb56297d0a56959b216">More...</a><br/></td></tr>
<tr class="separator:a93b2ab024cf83bb56297d0a56959b216"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c36a4eb5ce0d6086978b6465e879fbf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmaccepa_8h.html#a9c36a4eb5ce0d6086978b6465e879fbf">maccepa_model_get_spring_force</a> (double *f, double *x, double *u, <a class="el" href="structmaccepa__model.html">maccepa_model</a> *<a class="el" href="mex__libmaccepa_8c.html#af6904ccacb333f437667d0a0511bd11a">model</a>)</td></tr>
<tr class="memdesc:a9c36a4eb5ce0d6086978b6465e879fbf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate spring force as a function of current state and command.  <a href="#a9c36a4eb5ce0d6086978b6465e879fbf">More...</a><br/></td></tr>
<tr class="separator:a9c36a4eb5ce0d6086978b6465e879fbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74a343bea3440f6e7c9bc0bef0acfd26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="libmaccepa_8h.html#a74a343bea3440f6e7c9bc0bef0acfd26">maccepa_model_get_motor_positions</a> (double *m, double *x, <a class="el" href="structmaccepa__model.html">maccepa_model</a> *<a class="el" href="mex__libmaccepa_8c.html#af6904ccacb333f437667d0a0511bd11a">model</a>)</td></tr>
<tr class="memdesc:a74a343bea3440f6e7c9bc0bef0acfd26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate motor positions based on finite impulse response filters.  <a href="#a74a343bea3440f6e7c9bc0bef0acfd26">More...</a><br/></td></tr>
<tr class="separator:a74a343bea3440f6e7c9bc0bef0acfd26"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Library of functions for calculating dynamics properties of the MACCEPA. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a90055175283111ee3fa02a60f151f5d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maccepa_model_get_acceleration </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>acc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmaccepa__model.html">maccepa_model</a> *&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate joint accleration as a function of current state and command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">acc</td><td>joint acceleration </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>state (velocity, acceleration) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>command (motor positions in radiens) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>model struct</td></tr>
  </table>
  </dd>
</dl>
<p>This implements <img class="formulaInl" alt="$ \ddot{q}(\mathbf{x},\mathbf{u}) = (\tau_{actuators} - \tau_{damping} - \tau_{gravity} - \tau_{friction})/I $" src="form_13.png"/> </p>

<p>References <a class="el" href="structmaccepa__model.html#a61adb4645717c3523f1e269c366be950">maccepa_model::inertia</a>, and <a class="el" href="libmaccepa_8c.html#a153d0c93d90ccfd837f09dc78f77cdea">maccepa_model_get_torque()</a>.</p>

<p>Referenced by <a class="el" href="mex__libmaccepa_8c.html#a6a215cbfde54f82a3ce599228fc3fce5">mexFunction()</a>.</p>

</div>
</div>
<a class="anchor" id="aa861367ea3a44ba3ab6eaceff0a10f59"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maccepa_model_get_actuator_torque </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmaccepa__model.html">maccepa_model</a> *&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate joint torque due to actuators as a function of current state and command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">tau</td><td>torque </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>state (velocity, acceleration) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>command (motor positions in radiens) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>model struct</td></tr>
  </table>
  </dd>
</dl>
<p>This implements <img class="formulaInl" alt="$ \tau(q,\mathbf{u}) = \kappa BC\sin(u_1-q)\left(1+\frac{ru_2-(C-B)}{\sqrt{B^2 + C^2 - 2BC\cos(u_1-q)}}\right)$" src="form_44.png"/></p>
<dl class="section note"><dt>Note</dt><dd>This calculation is based on the derivation given in: Ham, R. V.; Vanderborght, B.; Damme, M. V.; Verrelst, B. &amp; Lefeber, D. MACCEPA, the mechanically adjustable compliance and controllable equilibrium position actuator: Design and implementation in a biped robot, Robotics and Autonomous Systems, 2007, 55, 761-768 </dd></dl>

<p>References <a class="el" href="structmaccepa__model.html#a99f88f7c3ad5748aaeec72b5fdff6c4d">maccepa_model::drum_radius</a>, <a class="el" href="structmaccepa__model.html#aacc28bd0871cd594a5184e04d182e322">maccepa_model::lever_length</a>, <a class="el" href="structmaccepa__model.html#a2737bb1187a5eb8ff1d4420ac7e208f2">maccepa_model::pin_displacement</a>, and <a class="el" href="structmaccepa__model.html#ae2c93b03a5aefd648bb2b1cd16cf441e">maccepa_model::spring_constant</a>.</p>

<p>Referenced by <a class="el" href="libmaccepa_8h.html#a153d0c93d90ccfd837f09dc78f77cdea">maccepa_model_get_torque()</a>, and <a class="el" href="mex__libmaccepa_8c.html#a6a215cbfde54f82a3ce599228fc3fce5">mexFunction()</a>.</p>

</div>
</div>
<a class="anchor" id="a93b2ab024cf83bb56297d0a56959b216"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maccepa_model_get_damping </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmaccepa__model.html">maccepa_model</a> *&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate damping as a function of current state and command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">b</td><td>joint damping </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>state (position, velocity) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>command (motor positions (rad), damping command (duty cycle)) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>model struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This is a place holder for a damping model!</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000005">Todo:</a></b></dt><dd>Integrate model of damper motor here. </dd></dl>

<p>References <a class="el" href="structmaccepa__model.html#a725bd21c7c250c668249da9935f59deb">maccepa_model::damping_constant</a>.</p>

<p>Referenced by <a class="el" href="libmaccepa_8h.html#a5a90a2eb7a82c0f133fb85a24dd5ccd6">maccepa_model_get_damping_torque()</a>.</p>

</div>
</div>
<a class="anchor" id="a5a90a2eb7a82c0f133fb85a24dd5ccd6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maccepa_model_get_damping_torque </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmaccepa__model.html">maccepa_model</a> *&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate joint torque due to damping as a function of current state and command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">tau</td><td>torque </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>state (velocity, acceleration) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>command (motor positions in radiens) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>model struct</td></tr>
  </table>
  </dd>
</dl>
<p>This implements <img class="formulaInl" alt="$ \tau(\mathbf{x},\mathbf{u}) = b_c\dot{q} $" src="form_22.png"/></p>
<dl class="section note"><dt>Note</dt><dd>Currently, if VARIABLE_DAMPING is defined, this returns zero torque. Temporarily, the damping modelling is being done on the Matlab side until we get a good damping model (or until we know the right model to use). </dd></dl>

<p>References <a class="el" href="libmaccepa_8c.html#a93b2ab024cf83bb56297d0a56959b216">maccepa_model_get_damping()</a>.</p>

<p>Referenced by <a class="el" href="libmaccepa_8h.html#a153d0c93d90ccfd837f09dc78f77cdea">maccepa_model_get_torque()</a>.</p>

</div>
</div>
<a class="anchor" id="aad92b4505d52c236c7d2068e8b99791d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maccepa_model_get_equilibrium_position </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>q0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmaccepa__model.html">maccepa_model</a> *&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate equilibrium position as a function of current state and command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">q0</td><td>joint equilibrium position </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>state (velocity, acceleration) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>command (motor positions in radiens) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>model struct</td></tr>
  </table>
  </dd>
</dl>
<p>This implements <img class="formulaInl" alt="$q_{0}=u_1$" src="form_37.png"/> </p>

<p>Referenced by <a class="el" href="mex__libmaccepa_8c.html#a6a215cbfde54f82a3ce599228fc3fce5">mexFunction()</a>.</p>

</div>
</div>
<a class="anchor" id="a92626951a8b47ac95bd28dd4b2e7de67"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maccepa_model_get_equilibrium_position_jacobian </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmaccepa__model.html">maccepa_model</a> *&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Jacobian of equilibrium position with respect to motor commands (as a function of current state and command). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">J</td><td>joint equilibrium position </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>state (velocity, acceleration) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>command (motor positions in radiens) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>model struct</td></tr>
  </table>
  </dd>
</dl>
<p>This implements <img class="formulaInl" alt="$\mathbf{J}_{q_0}=(1,0,0)^\top$" src="form_46.png"/> </p>

<p>Referenced by <a class="el" href="mex__libmaccepa_8c.html#a6a215cbfde54f82a3ce599228fc3fce5">mexFunction()</a>.</p>

</div>
</div>
<a class="anchor" id="abea5459436526c29a64c767d2ec55b77"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maccepa_model_get_friction_torque </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmaccepa__model.html">maccepa_model</a> *&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate joint torque due to friction as a function of current state and command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">tau</td><td>torque </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>state (velocity, acceleration) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>command (motor positions in radiens) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>model struct</td></tr>
  </table>
  </dd>
</dl>
<p>This implements <img class="formulaInl" alt="$ \tau(\mathbf{x},\mathbf{u}) = f_v \dot{q} + f_c sign(\dot{q}) $" src="form_24.png"/> where <img class="formulaInl" alt="$ f_v $" src="form_25.png"/> and <img class="formulaInl" alt="$ f_c $" src="form_26.png"/> are the viscous and Coulomb friction constants, respectively. </p>

<p>References <a class="el" href="structmaccepa__model.html#a8ae315701ba00d5e75676b813f302f86">maccepa_model::coulomb_friction</a>, and <a class="el" href="structmaccepa__model.html#a84702a8e361e208b4d694d02517105d6">maccepa_model::viscous_friction</a>.</p>

<p>Referenced by <a class="el" href="libmaccepa_8h.html#a153d0c93d90ccfd837f09dc78f77cdea">maccepa_model_get_torque()</a>.</p>

</div>
</div>
<a class="anchor" id="a4520c909672c79ec90df9a6cf224d568"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maccepa_model_get_gravity_torque </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmaccepa__model.html">maccepa_model</a> *&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate joint torque due to gravity as a function of current state and command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">tau</td><td>torque </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>state (velocity, acceleration) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>command (motor positions in radiens) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>model struct</td></tr>
  </table>
  </dd>
</dl>
<p>This implements <img class="formulaInl" alt="$ \tau(\mathbf{x},\mathbf{u}) = g_c\sin{q} $" src="form_23.png"/> </p>

<p>References <a class="el" href="structmaccepa__model.html#a58be96660e260d6733e3d265567e1dbd">maccepa_model::gravity_constant</a>.</p>

<p>Referenced by <a class="el" href="libmaccepa_8h.html#a153d0c93d90ccfd837f09dc78f77cdea">maccepa_model_get_torque()</a>.</p>

</div>
</div>
<a class="anchor" id="a74a343bea3440f6e7c9bc0bef0acfd26"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maccepa_model_get_motor_positions </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmaccepa__model.html">maccepa_model</a> *&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate motor positions based on finite impulse response filters. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">m</td><td>motor positions </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>filter states (velocity, acceleration) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>model struct </td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>This function is no longer used and should be removed. </dd></dl>

<p>References <a class="el" href="structmaccepa__model.html#a90c25ab1b3092620955508205a4d52e3">maccepa_model::b_filter</a>.</p>

<p>Referenced by <a class="el" href="mex__libmaccepa_8c.html#a6a215cbfde54f82a3ce599228fc3fce5">mexFunction()</a>.</p>

</div>
</div>
<a class="anchor" id="a9c36a4eb5ce0d6086978b6465e879fbf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maccepa_model_get_spring_force </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmaccepa__model.html">maccepa_model</a> *&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate spring force as a function of current state and command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">force</td><td>spring force </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>state (velocity, acceleration) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>command (motor positions in radiens) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>model struct</td></tr>
  </table>
  </dd>
</dl>
<p>This implements <img class="formulaInl" alt="$ F = \kappa (l-l_0) $" src="form_47.png"/> where <img class="formulaInl" alt="$ l-l_0 $" src="form_48.png"/> is the spring extension. </p>

<p>References <a class="el" href="structmaccepa__model.html#a99f88f7c3ad5748aaeec72b5fdff6c4d">maccepa_model::drum_radius</a>, <a class="el" href="structmaccepa__model.html#aacc28bd0871cd594a5184e04d182e322">maccepa_model::lever_length</a>, <a class="el" href="structmaccepa__model.html#a2737bb1187a5eb8ff1d4420ac7e208f2">maccepa_model::pin_displacement</a>, and <a class="el" href="structmaccepa__model.html#ae2c93b03a5aefd648bb2b1cd16cf441e">maccepa_model::spring_constant</a>.</p>

<p>Referenced by <a class="el" href="mex__libmaccepa_8c.html#a6a215cbfde54f82a3ce599228fc3fce5">mexFunction()</a>.</p>

</div>
</div>
<a class="anchor" id="aa4d7524d48f4b1fd42b060e07a96d235"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maccepa_model_get_stiffness </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmaccepa__model.html">maccepa_model</a> *&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate stiffness as a function of current state and command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">k</td><td>joint stiffness </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>state (velocity, acceleration) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>command (motor positions in radiens) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>model struct</td></tr>
  </table>
  </dd>
</dl>
<p>This implements <img class="formulaInl" alt="$k(q,\mathbf{u})=-\frac{\partial\tau}{\partial q}|_{q}= \kappa BC\cos(u_1-q)\left(1+\frac{(ru_2-(C-B)}{\sqrt{B^2+C^2-2BC\cos(u_1-q)}}\right) -\frac{\kappa B^2 C^2\sin^2(u_1-q)(ru_2-(C-B))}{(B^2+C^2-2BC\cos(u_1-q))^{\frac{3}{2}}}$" src="form_45.png"/></p>
<p>where <img class="formulaInl" alt="$\tau$" src="form_28.png"/> is the actuator torque (i.e., torque due to the variable stiffness mechanism). </p>

<p>References <a class="el" href="structmaccepa__model.html#a99f88f7c3ad5748aaeec72b5fdff6c4d">maccepa_model::drum_radius</a>, <a class="el" href="structmaccepa__model.html#aacc28bd0871cd594a5184e04d182e322">maccepa_model::lever_length</a>, <a class="el" href="structmaccepa__model.html#a2737bb1187a5eb8ff1d4420ac7e208f2">maccepa_model::pin_displacement</a>, and <a class="el" href="structmaccepa__model.html#ae2c93b03a5aefd648bb2b1cd16cf441e">maccepa_model::spring_constant</a>.</p>

<p>Referenced by <a class="el" href="libmaccepa_8h.html#a4af92c8a3f2a091b4e4afa7c688d43a4">maccepa_model_get_stiffness_jacobian()</a>, and <a class="el" href="mex__libmaccepa_8c.html#a6a215cbfde54f82a3ce599228fc3fce5">mexFunction()</a>.</p>

</div>
</div>
<a class="anchor" id="a4af92c8a3f2a091b4e4afa7c688d43a4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maccepa_model_get_stiffness_jacobian </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmaccepa__model.html">maccepa_model</a> *&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate Jacobian of stiffness with respect to motor commands (as a function of current state and command). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">J</td><td>joint stiffness Jacobian </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>state (velocity, acceleration) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>command (motor positions in radiens) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>model struct</td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>This calculation is currently based on finite differences. Accuracy and effieciency could be improved by finding the analytic expression for this. </dd></dl>

<p>References <a class="el" href="libedinburghvsa_8h.html#ae00baf3ee46a1a8c6250170ce33bc62e">DIMU</a>, and <a class="el" href="libmaccepa_8c.html#aa4d7524d48f4b1fd42b060e07a96d235">maccepa_model_get_stiffness()</a>.</p>

<p>Referenced by <a class="el" href="mex__libmaccepa_8c.html#a6a215cbfde54f82a3ce599228fc3fce5">mexFunction()</a>.</p>

</div>
</div>
<a class="anchor" id="a153d0c93d90ccfd837f09dc78f77cdea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maccepa_model_get_torque </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>tau</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structmaccepa__model.html">maccepa_model</a> *&#160;</td>
          <td class="paramname"><em>model</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate total joint torque as a function of current state and command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">tau</td><td>torque </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>state (velocity, acceleration) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>command (motor positions in radiens) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">model</td><td>model struct</td></tr>
  </table>
  </dd>
</dl>
<p>This implements <img class="formulaInl" alt="$ \tau(\mathbf{x},\mathbf{u}) = \tau_{actuators} - \tau_{damping} - \tau_{gravity} - \tau_{friction} $" src="form_43.png"/> </p>

<p>References <a class="el" href="libmaccepa_8c.html#aa861367ea3a44ba3ab6eaceff0a10f59">maccepa_model_get_actuator_torque()</a>, <a class="el" href="libmaccepa_8c.html#a5a90a2eb7a82c0f133fb85a24dd5ccd6">maccepa_model_get_damping_torque()</a>, <a class="el" href="libmaccepa_8c.html#abea5459436526c29a64c767d2ec55b77">maccepa_model_get_friction_torque()</a>, and <a class="el" href="libmaccepa_8c.html#a4520c909672c79ec90df9a6cf224d568">maccepa_model_get_gravity_torque()</a>.</p>

<p>Referenced by <a class="el" href="libmaccepa_8h.html#a90055175283111ee3fa02a60f151f5d5">maccepa_model_get_acceleration()</a>.</p>

</div>
</div>
<a class="anchor" id="a222ddd307288e014996419e1b717a8a9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void maccepa_model_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structmaccepa__model.html">maccepa_model</a> *&#160;</td>
          <td class="paramname"><em>model</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise model struct (set default parameters). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">model</td><td>model struct. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="structmaccepa__model.html#a90c25ab1b3092620955508205a4d52e3">maccepa_model::b_filter</a>, <a class="el" href="structmaccepa__model.html#a8ae315701ba00d5e75676b813f302f86">maccepa_model::coulomb_friction</a>, <a class="el" href="structmaccepa__model.html#a725bd21c7c250c668249da9935f59deb">maccepa_model::damping_constant</a>, <a class="el" href="structmaccepa__model.html#a99f88f7c3ad5748aaeec72b5fdff6c4d">maccepa_model::drum_radius</a>, <a class="el" href="structmaccepa__model.html#a58be96660e260d6733e3d265567e1dbd">maccepa_model::gravity_constant</a>, <a class="el" href="structmaccepa__model.html#a61adb4645717c3523f1e269c366be950">maccepa_model::inertia</a>, <a class="el" href="structmaccepa__model.html#aacc28bd0871cd594a5184e04d182e322">maccepa_model::lever_length</a>, <a class="el" href="structmaccepa__model.html#ab20381b360f0b885ce9d6cf1399aaa3c">maccepa_model::link_length</a>, <a class="el" href="structmaccepa__model.html#a2737bb1187a5eb8ff1d4420ac7e208f2">maccepa_model::pin_displacement</a>, <a class="el" href="structmaccepa__model.html#ae2c93b03a5aefd648bb2b1cd16cf441e">maccepa_model::spring_constant</a>, <a class="el" href="structmaccepa__model.html#a8f08b9fcce1e6f0eb5762870f2c18d0d">maccepa_model::umax</a>, <a class="el" href="structmaccepa__model.html#aff3ae38dcc264ba473b8e1a0589e3da5">maccepa_model::umin</a>, and <a class="el" href="structmaccepa__model.html#a84702a8e361e208b4d694d02517105d6">maccepa_model::viscous_friction</a>.</p>

<p>Referenced by <a class="el" href="mex__libmaccepa_8c.html#a6a215cbfde54f82a3ce599228fc3fce5">mexFunction()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Jan 28 2016 17:19:57 for Hardware Toolbox by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
